<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:c="http://java.sun.com/jsp/jstl/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://java.sun.com/jsf/core">

    <h:head>
        <title>ImageEditor</title>

        <h:outputScript library="primefaces" name="jquery/jquery.js" target="head"/>
        <h:outputScript library="primefaces" name="jquery/jquery-plugins.js" target="head"/>
        <h:outputScript library="js" name="jquery-ui.js" target="head"/>
        <h:outputScript library="js" name="jquery-ui.min.js" target="head"/>

        <!-- Fabrics -->
        <h:outputScript library="js" name="fabric.js" target="head"/>
        <h:outputScript library="js" name="fabric.min.js" target="head"/>
        <h:outputScript library="js" name="fabric.require.js" target="head"/>


        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css"/>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css"/>



        <style>

        </style>

        <script type='text/javascript'>

            $ = jQuery;
            // create a wrapper around native canvas element (with id="c")
            var canvas;
            var radius = 300;

            $(function () {
                canvas = new fabric.Canvas('c');
                fabric.Object.prototype.transparentCorners = false;
            });


            $(document).on("click", ".canvasBack",
                    function () {

                        canvas.setBackgroundImage($(this).attr("src"), canvas.renderAll.bind(canvas), {
                            backgroundImageOpacity: 0.5,
                            backgroundImageStretch: true
                        });

                    });

            $(document).on("click", ".fillBackGround",
                    function () {
                        
                        alert($("#imgEditor\\:fillBackGround").val());
                        

                    });

            $(document).on("click", ".tocanvas",
                    function () {

                        fabric.Image.fromURL($(this).attr("src"), function (img) {
                            img.scale(0.4).set({
                                left: 100,
                                top: 100
                            });
                            canvas.add(img).setActiveObject(img);
                        });
                    });


            $(document).on("click", "#textToCanvasBtn",
                    function () {
                        var text = $("#imgEditor\\:textToCanvas").val();

                        var shadowText1 = new fabric.Text(text, {
                            shadow: 'rgba(0,0,0,0.3) 5px 5px 5px'
                        });

                        canvas.add(shadowText1);

                        return false;
                    });

        </script>




    </h:head>


    <h:body>
        <p:layout fullPage="true">

            <p:growl id="growl" showDetail="true" sticky="true" />  

            <p:layoutUnit position="west" size="700" resizable="false">


                <canvas id="c" width="600" height="600" style="border:1px solid #aaa"></canvas>

            </p:layoutUnit>


            <p:layoutUnit position="center"  >
                <h:form id="imgEditor">
                    <img width="300px;" src="/SurixonDemo/resources/images/volkswagen_bee.png" height="250px;" class="tocanvas"/>

                    <img width="300px;" src="/SurixonDemo/resources/images/volkswagen_golf.png" height="250px;" class="tocanvas"/>
                    <h:panelGrid columns="2" cellpadding="5">
                        <p:inputText  id="textToCanvas" />


                        <button id="textToCanvasBtn" type="button" class="btn btn-primary" title="Add text">
                            <span id="zoomIn" class="docs-tooltip" >
                                <span class="fa fa-pencil-square-o"></span>
                            </span>
                        </button>

                    </h:panelGrid>





                    <h:panelGrid columns="1">
                        <f:facet name="header">
                            Set background color
                        </f:facet>



                        <p:colorPicker id="colorPick" value="#{imageController.colorInline}" mode="inline" />

                        <button id="fillBackGround" type="button" class="btn btn-primary" title="Add text">
                            <span id="zoomIn" class="docs-tooltip" >
                                <span class="fa fa-paint-brush"></span>
                            </span>
                        </button>
                    </h:panelGrid>
                </h:form>
            </p:layoutUnit>


        </p:layout>
    </h:body>



</html>

